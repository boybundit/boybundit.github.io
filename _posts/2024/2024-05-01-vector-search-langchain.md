---
layout: post
title: ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô Vector Search ‡∏î‡πâ‡∏ß‡∏¢ LangChain
slug: vector-search-langchain
date: 2024-05-01 +0700
categories: data_science
---

‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏á‡∏≤‡∏ô Microsoft Build: AI Day ‡∏°‡∏≤ ‡∏°‡∏µ demo ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ vector search ‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏î‡∏µ ‡πÄ‡∏•‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏î‡∏π‡∏ã‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÜ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏ï‡πà‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà LLM ‡∏°‡∏±‡∏ô hype ‡∏°‡∏≤‡∏Å‡πÜ ‡πÑ‡∏≠‡πâ‡πÄ‡∏à‡πâ‡∏≤ vector database ‡∏°‡∏±‡∏ô‡πÄ‡∏•‡∏¢ hype ‡∏ï‡∏≤‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢ üòÇ

‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡πÜ LLM ‡∏´‡∏£‡∏∑‡∏≠ technology ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á ChatGPT ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà step ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á text ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô vector ‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏≤‡∏Å text ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡∏ó‡∏µ‡πà feed ‡πÄ‡∏õ‡πá‡∏ô input ‡πÉ‡∏´‡πâ ANN ‡πÑ‡∏î‡πâ ‡∏ã‡∏∂‡πà‡∏á ‡πÄ‡∏à‡πâ‡∏≤ vector ‡∏Å‡πá‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏Ç‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡πÄ‡∏•‡∏¢ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ó‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ‡πÉ‡∏ô‡∏£‡∏∞‡∏ô‡∏≤‡∏ö 2 ‡∏°‡∏¥‡∏ï‡∏¥ ‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ (x, y) ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô vector 2 ‡∏°‡∏¥‡∏ï‡∏¥ ‡∏ó‡∏µ‡∏ô‡∏µ‡πâ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏µ‡πà‡∏°‡∏¥‡∏ï‡∏¥‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "Cat" ‡∏î‡πâ‡∏ß‡∏¢ vector (0.12, 0.45, -0,34, 0.82, 0.34) üê±

‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤ embbeding ‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á features ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ä‡∏∏‡∏î‡∏ô‡∏∂‡∏á‡πÄ‡∏•‡∏¢ ‡∏ó‡∏µ‡πà‡∏´‡∏ß‡∏±‡∏á‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏•‡∏Ç‡∏°‡∏±‡∏ô‡∏≠‡∏≤‡∏à‡∏à‡∏∞ represent concept ‡∏≠‡∏∞‡πÑ‡∏£‡∏ã‡∏±‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á text ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏°‡∏µ objective ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ text ‡∏ó‡∏µ‡πà "‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢" ‡∏Å‡∏±‡∏ô ‡∏û‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô vector ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏à‡∏∞ "‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢" ‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡πà‡∏≤ vector ‡∏™‡∏≠‡∏á‡∏≠‡∏±‡∏ô‡∏°‡∏±‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏Å‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡πá‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∏‡πâ‡∏ô‡πÄ‡∏Ñ‡∏¢‡∏™‡∏°‡∏±‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏Ç ‡∏Å‡πá‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏î‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á vector ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ Cosine Similarity ‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏•‡∏Ç‡∏ô‡πâ‡∏≠‡∏¢‡∏¢‡∏¥‡πà‡∏á‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å

![image](/assets/images/2024-05-01-vector-search-langchain/cosine-similarity.png "https://medium.com/@milana.shxanukova15/cosine-distance-and-cosine-similarity-a5da0e4d9ded")

‡∏ã‡∏∂‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ô‡∏µ‡πâ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ search ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤ document ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö "Cat" ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡πÑ‡∏õ‡πÑ‡∏•‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì similarilty ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å document ‡∏°‡∏±‡∏ô‡∏Å‡πá‡∏à‡∏∞‡∏ä‡πâ‡∏≤ ‡∏°‡∏±‡∏ô‡∏Å‡πá‡∏à‡∏∞‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢ algorithm ‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Å‡πá‡πÄ‡∏•‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á vector database ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏ó‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏ß‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢ ‡πÅ‡∏ö‡∏ö one-stop service ‡πÄ‡∏£‡∏≤‡πÅ‡∏Ñ‡πà‡πÄ‡∏Å‡πá‡∏ö text ‡∏•‡∏á‡πÑ‡∏õ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á similarity search ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏á‡∏ï‡∏≠‡∏ô query ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡∏¢ ‡∏ä‡∏¥‡∏•‡πÜ üòé

![image](/assets/images/2024-05-01-vector-search-langchain/vector-store.jpg "https://python.langchain.com/docs/modules/data_connection/vectorstores/")

‡πÄ‡∏≠‡∏≤‡∏•‡πà‡∏∞ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à concept ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Å‡∏±‡∏ô‡∏û‡∏≠‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏≤‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡∏±‡∏ô‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤! ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ library ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ LangChain ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å load file csv ‡∏ó‡∏µ‡πà‡∏°‡∏µ list ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô

```python
from langchain_community.document_loaders.csv_loader import CSVLoader

loader = CSVLoader(file_path='words.csv', csv_args={
    'fieldnames': ['Words']
})

data = loader.load()
```

```csv
Words
Cat
Dog
Car
Truck
Computer
Laptop
Apple
Orange
Music
Dance
```

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏¢‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏•‡∏á vector store ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ FAISS ‡∏Ç‡∏≠‡∏á Facebook ‡πÇ‡∏î‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ model ‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á embeddings ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ all-MiniLM-L6-v2 ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏±‡∏ô run local ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏¥‡∏á API ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏û‡∏ß‡∏Å model ‡∏Ç‡∏≠‡∏á OpenAI

```python
from langchain_community.embeddings import SentenceTransformerEmbeddings
from langchain_community.vectorstores import FAISS

embedding_model = SentenceTransformerEmbeddings(model_name="all-MiniLM-L6-v2")

db = FAISS.from_documents(data, embedding_model)
```

‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏û‡∏£‡πâ‡∏≠‡∏° search ‡πÅ‡∏•‡πâ‡∏ß ‡πÇ‡∏î‡∏¢ function similarity_search ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ L2 distance ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á vector ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∑‡∏ô top 4 documents ‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏°‡∏≤‡πÉ‡∏´‡πâ (‡πÄ‡∏•‡∏Ç‡∏ô‡πâ‡∏≠‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏Å)

```python
user_input = "Lion"
results = db.similarity_search_with_score(user_input)

for r in results:
  print(r[0].page_content, '\t', r[1])
```

```sh
Words: Cat       1.2079067
Words: Dog       1.2618062
Words: Apple     1.4635086
Words: Orange    1.4841197
```

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏î‡∏π‡∏£‡∏≤‡∏ß‡∏Å‡∏±‡∏ö‡∏ß‡πà‡∏≤ model ‡∏°‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡∏à‡∏ô "‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à" concept ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏ß‡πà‡∏≤ Lion ‡∏°‡∏±‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ Cat ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ Dog ‡∏ô‡∏∞ ‡∏ã‡∏∂‡πà‡∏á‡∏î‡∏π‡∏°‡∏´‡∏±‡∏®‡∏à‡∏£‡∏£‡∏¢‡πå‡∏°‡∏≤‡∏Å üòÆ ‡πÅ‡∏ï‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á knowledge graph ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤ expand keywords ‡∏ô‡∏π‡πà‡∏ô‡∏ô‡∏±‡πà‡∏ô‡∏ô‡∏µ‡πà‡∏ß‡∏∏‡πà‡∏ô‡∏ß‡∏≤‡∏¢

‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡∏á‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡∏°‡∏±‡∏ô‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô model ‡∏ô‡∏±‡πà‡∏ô‡πÅ‡∏´‡∏•‡∏∞‡∏ß‡πà‡∏≤ train ‡∏°‡∏≤‡∏¢‡∏±‡∏á‡∏á‡∏±‡∏¢ 555+

‡πÑ‡∏õ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ô‡∏î‡∏π‡∏Ñ‡∏£‡∏±‡∏ö ‡∏à‡∏∞‡πÑ‡∏î‡πâ hype ‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á üòÇ
